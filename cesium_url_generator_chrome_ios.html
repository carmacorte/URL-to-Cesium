<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Generador de URL para Cesium (solo FJZ)</title>
</head>
<body>
  <h1>Generador de URL para Cesium (solo FJZ)</h1>

  <label>UUT Type (separado por comas si son varios):</label><br />
  <input type="text" id="uutType" value="800-110945-%,800-110045-%" style="width: 100%;" /><br /><br />

  <label>Fecha inicio:</label><br />
  <input type="date" id="startDate" /><br /><br />

  <label>Fecha fin:</label><br />
  <input type="date" id="endDate" /><br /><br />

  <label>URL generada:</label><br />
  <textarea id="urlOutput" style="width: 100%; height: 100px;"></textarea><br /><br />

  <button onclick="openInBrowser()">Abrir en navegador</button>

  <script>
    function encodeUUT(value) {
      return value
        .split(',')
        .map(v => v.trim().replace(/%/g, '%25'))  // Escapa %
        .join(',');
    }

    function generateURL() {
      const uutRaw = document.getElementById('uutType').value;
      const uutEncoded = encodeUUT(uutRaw);
      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;

      const baseURL = 'https://cesium.cisco.com/apps/PolarisSearch/AdvanceYield';
      const params = `?SI=${uutEncoded},Fjz&SD=${startDate}&ED=${endDate}&datetype=nodate&yieldtype=firstpass&yielddatetype=rectime&uuttype=${uutEncoded}&location=Fjz&timezone=US%2FMountain`;

      const fullURL = baseURL + params;
      document.getElementById('urlOutput').value = fullURL;
    }

    function openInBrowser() {
      generateURL();
      const url = document.getElementById('urlOutput').value;
      window.open(url, '_blank');
    }

    // Autorellenar con fecha de hoy
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('startDate').value = today;
    document.getElementById('endDate').value = today;
  </script>
</body>
</html>